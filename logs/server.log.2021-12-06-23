[2021-12-06 23:01:47,616] INFO [GroupCoordinator 0]: Preparing to rebalance group my-first-app in state PreparingRebalance with old generation 20 (__consumer_offsets-13) (reason: Leader consumer-my-first-app-1-6323d411-8bff-44a4-a760-5eda0990ea48 re-joining group during Stable) (kafka.coordinator.group.GroupCoordinator)
[2021-12-06 23:01:47,618] INFO [GroupCoordinator 0]: Stabilized group my-first-app generation 21 (__consumer_offsets-13) with 1 members (kafka.coordinator.group.GroupCoordinator)
[2021-12-06 23:01:47,622] INFO [GroupCoordinator 0]: Assignment received from leader consumer-my-first-app-1-6323d411-8bff-44a4-a760-5eda0990ea48 for group my-first-app for generation 21. The group has 1 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator)
[2021-12-06 23:23:17,038] INFO [GroupCoordinator 0]: Dynamic member with unknown member id joins group my-first-app in Stable state. Created a new member id consumer-my-first-app-1-0b94b682-ec8e-4ce8-8ec2-6be0c108737c and request the member to rejoin with this id. (kafka.coordinator.group.GroupCoordinator)
[2021-12-06 23:23:17,039] INFO [GroupCoordinator 0]: Preparing to rebalance group my-first-app in state PreparingRebalance with old generation 21 (__consumer_offsets-13) (reason: Adding new member consumer-my-first-app-1-0b94b682-ec8e-4ce8-8ec2-6be0c108737c with group instance id None) (kafka.coordinator.group.GroupCoordinator)
[2021-12-06 23:23:17,858] INFO [GroupCoordinator 0]: Stabilized group my-first-app generation 22 (__consumer_offsets-13) with 2 members (kafka.coordinator.group.GroupCoordinator)
[2021-12-06 23:23:17,914] INFO [GroupCoordinator 0]: Assignment received from leader consumer-my-first-app-1-6323d411-8bff-44a4-a760-5eda0990ea48 for group my-first-app for generation 22. The group has 2 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator)
[2021-12-06 23:39:45,631] ERROR Error while writing to checkpoint file /home/tuyen/kafka_2.13-3.0.0/data/kafka/replication-offset-checkpoint (kafka.server.LogDirFailureChannel)
java.io.FileNotFoundException: /home/tuyen/kafka_2.13-3.0.0/data/kafka/replication-offset-checkpoint.tmp (No such file or directory)
	at java.base/java.io.FileOutputStream.open0(Native Method)
	at java.base/java.io.FileOutputStream.open(FileOutputStream.java:298)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:237)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:187)
	at kafka.server.checkpoints.CheckpointFile.liftedTree1$1(CheckpointFile.scala:94)
	at kafka.server.checkpoints.CheckpointFile.write(CheckpointFile.scala:92)
	at kafka.server.checkpoints.OffsetCheckpointFile.write(OffsetCheckpointFile.scala:67)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7(ReplicaManager.scala:1830)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7$adapted(ReplicaManager.scala:1830)
	at scala.Option.foreach(Option.scala:437)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6(ReplicaManager.scala:1830)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6$adapted(ReplicaManager.scala:1829)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at scala.collection.IterableOps$WithFilter.foreach(Iterable.scala:889)
	at kafka.server.ReplicaManager.checkpointHighWatermarks(ReplicaManager.scala:1829)
	at kafka.server.ReplicaManager.$anonfun$startHighWatermarkCheckPointThread$1(ReplicaManager.scala:283)
	at kafka.utils.KafkaScheduler.$anonfun$schedule$2(KafkaScheduler.scala:114)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2021-12-06 23:39:45,643] WARN [ReplicaManager broker=0] Stopping serving replicas in dir /home/tuyen/kafka_2.13-3.0.0/data/kafka (kafka.server.ReplicaManager)
[2021-12-06 23:39:45,643] ERROR [ReplicaManager broker=0] Error while writing to highwatermark file in directory /home/tuyen/kafka_2.13-3.0.0/data/kafka (kafka.server.ReplicaManager)
org.apache.kafka.common.errors.KafkaStorageException: Error while writing to checkpoint file /home/tuyen/kafka_2.13-3.0.0/data/kafka/replication-offset-checkpoint
Caused by: java.io.FileNotFoundException: /home/tuyen/kafka_2.13-3.0.0/data/kafka/replication-offset-checkpoint.tmp (No such file or directory)
	at java.base/java.io.FileOutputStream.open0(Native Method)
	at java.base/java.io.FileOutputStream.open(FileOutputStream.java:298)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:237)
	at java.base/java.io.FileOutputStream.<init>(FileOutputStream.java:187)
	at kafka.server.checkpoints.CheckpointFile.liftedTree1$1(CheckpointFile.scala:94)
	at kafka.server.checkpoints.CheckpointFile.write(CheckpointFile.scala:92)
	at kafka.server.checkpoints.OffsetCheckpointFile.write(OffsetCheckpointFile.scala:67)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7(ReplicaManager.scala:1830)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$7$adapted(ReplicaManager.scala:1830)
	at scala.Option.foreach(Option.scala:437)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6(ReplicaManager.scala:1830)
	at kafka.server.ReplicaManager.$anonfun$checkpointHighWatermarks$6$adapted(ReplicaManager.scala:1829)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at scala.collection.IterableOps$WithFilter.foreach(Iterable.scala:889)
	at kafka.server.ReplicaManager.checkpointHighWatermarks(ReplicaManager.scala:1829)
	at kafka.server.ReplicaManager.$anonfun$startHighWatermarkCheckPointThread$1(ReplicaManager.scala:283)
	at kafka.utils.KafkaScheduler.$anonfun$schedule$2(KafkaScheduler.scala:114)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2021-12-06 23:39:45,645] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions HashSet(__consumer_offsets-22, __consumer_offsets-30, __consumer_offsets-25, __consumer_offsets-35, my-sec-topic-0, __consumer_offsets-37, __consumer_offsets-38, __consumer_offsets-13, __consumer_offsets-8, __consumer_offsets-21, __consumer_offsets-4, __consumer_offsets-27, __consumer_offsets-7, __consumer_offsets-9, __consumer_offsets-46, __consumer_offsets-41, __consumer_offsets-33, __consumer_offsets-23, __consumer_offsets-49, __consumer_offsets-47, __consumer_offsets-16, __consumer_offsets-28, __consumer_offsets-31, __consumer_offsets-36, __consumer_offsets-42, __consumer_offsets-3, __consumer_offsets-18, __consumer_offsets-15, __consumer_offsets-24, __consumer_offsets-17, __consumer_offsets-48, my-first-topic-0, __consumer_offsets-19, __consumer_offsets-11, __consumer_offsets-2, __consumer_offsets-43, __consumer_offsets-6, __consumer_offsets-14, __consumer_offsets-0, __consumer_offsets-44, my-first-topic-2, __consumer_offsets-20, __consumer_offsets-39, my-first-topic-1, __consumer_offsets-12, __consumer_offsets-45, __consumer_offsets-1, __consumer_offsets-5, __consumer_offsets-26, __consumer_offsets-29, __consumer_offsets-34, __consumer_offsets-10, __consumer_offsets-32, __consumer_offsets-40) (kafka.server.ReplicaFetcherManager)
[2021-12-06 23:39:45,645] INFO [ReplicaAlterLogDirsManager on broker 0] Removed fetcher for partitions HashSet(__consumer_offsets-22, __consumer_offsets-30, __consumer_offsets-25, __consumer_offsets-35, my-sec-topic-0, __consumer_offsets-37, __consumer_offsets-38, __consumer_offsets-13, __consumer_offsets-8, __consumer_offsets-21, __consumer_offsets-4, __consumer_offsets-27, __consumer_offsets-7, __consumer_offsets-9, __consumer_offsets-46, __consumer_offsets-41, __consumer_offsets-33, __consumer_offsets-23, __consumer_offsets-49, __consumer_offsets-47, __consumer_offsets-16, __consumer_offsets-28, __consumer_offsets-31, __consumer_offsets-36, __consumer_offsets-42, __consumer_offsets-3, __consumer_offsets-18, __consumer_offsets-15, __consumer_offsets-24, __consumer_offsets-17, __consumer_offsets-48, my-first-topic-0, __consumer_offsets-19, __consumer_offsets-11, __consumer_offsets-2, __consumer_offsets-43, __consumer_offsets-6, __consumer_offsets-14, __consumer_offsets-0, __consumer_offsets-44, my-first-topic-2, __consumer_offsets-20, __consumer_offsets-39, my-first-topic-1, __consumer_offsets-12, __consumer_offsets-45, __consumer_offsets-1, __consumer_offsets-5, __consumer_offsets-26, __consumer_offsets-29, __consumer_offsets-34, __consumer_offsets-10, __consumer_offsets-32, __consumer_offsets-40) (kafka.server.ReplicaAlterLogDirsManager)
[2021-12-06 23:39:45,663] WARN [ReplicaManager broker=0] Broker 0 stopped fetcher for partitions __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,my-sec-topic-0,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,my-first-topic-0,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-0,__consumer_offsets-44,my-first-topic-2,__consumer_offsets-20,__consumer_offsets-39,my-first-topic-1,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 and stopped moving logs for partitions  because they are in the failed log directory /home/tuyen/kafka_2.13-3.0.0/data/kafka. (kafka.server.ReplicaManager)
[2021-12-06 23:39:45,663] WARN Stopping serving logs in dir /home/tuyen/kafka_2.13-3.0.0/data/kafka (kafka.log.LogManager)
[2021-12-06 23:39:45,666] ERROR Shutdown broker because all log dirs in /home/tuyen/kafka_2.13-3.0.0/data/kafka have failed (kafka.log.LogManager)
